import{a3 as M,x as R,j as E,z as b,l as _,d as B,h as f,g as u,o as g,b as h,w as N,Z as k,k as y,n as T,N as D,r as O,e as S,H,X as j,$ as I,T as A,a4 as P,a1 as U,a2 as w}from"./framework.8bf404a1.js";import{R as V}from"./RenderVnode.5ecb0cb7.js";import{_ as X}from"./Icon.vue_vue_type_script_setup_true_lang.f72a7bdb.js";const q=(t,s,e)=>{M(t)?R(t,(n,i)=>{i==null||i.removeEventListener(s,e),n==null||n.addEventListener(s,e)}):E(()=>{t.addEventListener(s,e)}),b(()=>{var n;(n=_(t))==null||n.removeEventListener(s,e)})},F=q,G={class:"vk-message__content"},J={class:"vk-message__close"},K=B({name:"VkMessage",__name:"Message",props:{message:{},duration:{default:3e3},showClose:{type:Boolean},type:{default:"info"},onDestory:{},offset:{default:20},id:{},zIndex:{},transitionName:{default:"fade-up"}},setup(t,{expose:s}){const e=t;let n;function i(){e.duration!==0&&(n=setTimeout(()=>{a.value=!1},e.duration))}function p(){clearTimeout(n)}const a=f(!1),c=f(),m=f(0),v=u(()=>ee(e.id)),r=u(()=>e.offset+v.value),l=u(()=>m.value+r.value),z=u(()=>({top:r.value+"px",zIndex:e.zIndex}));E(async()=>{a.value=!0,i()});function L(){e.onDestory()}function Z(){m.value=c.value.getBoundingClientRect().height}function $(o){o.code==="Escape"&&(a.value=!1)}return F(document,"keydown",$),s({bottomOffset:l,visible:a}),(o,x)=>(g(),h(A,{name:o.transitionName,onEnter:Z,onAfterLeave:L},{default:N(()=>[k(y("div",{class:T(["vk-message",{[`vk-message--${o.type}`]:o.type,"is-close":o.showClose}]),ref_key:"messageRef",ref:c,style:D(z.value),onMouseenter:p,onMouseleave:i},[y("div",G,[O(o.$slots,"default",{},()=>[o.message?(g(),h(_(V),{key:0,"v-node":o.message},null,8,["v-node"])):S("",!0)])]),k(y("div",J,[H(X,{onClick:x[0]||(x[0]=j(se=>a.value=!1,["stop"])),icon:"xmark"})],512),[[I,o.showClose]])],38),[[I,a.value]])]),_:3},8,["name"]))}}),C=f(0),Q=(t=2e3)=>{const s=f(t),e=u(()=>C.value+s.value);return{currentZIndex:e,nextZIndex:()=>(C.value++,e.value),initialZIndex:s}},W=Q;let Y=1;const d=P([]),ae=t=>{const{nextZIndex:s}=W(),e=`message_${Y++}`,n=document.createElement("div"),i=()=>{const r=d.findIndex(l=>l.id===e);r!==-1&&(d.splice(r,1),w(null,n))},p=()=>{const r=d.find(l=>l.id===e);r&&(r.vm.exposed.visible.value=!1)},a={...t,id:e,onDestory:i,zIndex:s()},c=U(K,a);w(c,n),document.body.appendChild(n.firstElementChild);const m=c.component,v={id:e,vnode:c,vm:m,props:a,close:p};return d.push(v),v},ee=t=>{const s=d.findIndex(e=>e.id===t);return s<=0?0:d[s-1].vm.exposed.bottomOffset.value};export{ae as c};
